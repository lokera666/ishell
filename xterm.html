<!doctype html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link href="https://cdn.bootcdn.net/ajax/libs/xterm/3.9.2/xterm.min.css" rel="stylesheet">
  <link href="https://cdn.bootcdn.net/ajax/libs/xterm/3.9.2/addons/fullscreen/fullscreen.min.css" rel="stylesheet">
  <script src="https://cdn.bootcdn.net/ajax/libs/xterm/3.9.2/xterm.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/xterm/3.9.2/addons/fullscreen/fullscreen.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/xterm/3.9.2/addons/fit/fit.min.js"></script>
  <script type="text/javascript" src="qrc:/html/qwebchannel.js"></script>
  <style>
    ::-webkit-scrollbar {
      width: 0px;
    }
  </style>
</head>

<body style="padding: 0;margin: 0;">
  <div id="terminal" style="padding: 0;margin: 0;"></div>
</body>
<script type="text/javascript">
  var body_height = $(document).height() - 20;
  var body_width = $(document).width();
  $("#terminal").height(body_height);
  Terminal.applyAddon(fullscreen);
  Terminal.applyAddon(fit);
  var term = new Terminal({
    termName: "xterm",
    useStyle: true,
    convertEol: true,
    screenKeys: true,
    cursorBlink: true,
    visualBell: true,
    colors: Terminal.xtermColors,
  });
  term.open(document.getElementById('terminal'));
  term.fit();
  term.focus();
  term.scrollToBottom()
  term.on('data', (data) => {
    core.recieveJsMessage(data);
  });

  term.on('resize', function () {

  })

  function lineFeed() {
    term.write('\r\n ');
  }

  new QWebChannel(qt.webChannelTransport, function (channel) {
    window.core = channel.objects.core;
  });

  window.onresize = function () {
    var body_height = $(window).height() - 20;
    $("#terminal").height(body_height);
    term.fit()
    term.scrollToBottom()
  }
</script>

</html>
